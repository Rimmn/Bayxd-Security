name: üîí PROTECT CRITICAL FILES

on:
  push:
    branches: [main]
    paths:
      - 'index.js'
      - 'scurity.js'
      - 'handler.js'
      - 'settings.js'
      - 'database.json'

jobs:
  verify:
    runs-on: ubuntu-latest
    
    steps:
    - name: üìã Check Changed Files
      run: |
        echo "=== PROTECTION SYSTEM ==="
        echo "User: ${{ github.actor }}"
        echo "Event: ${{ github.event_name }}"
        echo ""
        
        # List files in repo (debug)
        echo "Files in repository:"
        find . -type f -name "*.js" -o -name "*.json" | head -20
        
    - name: üîê Owner Verification
      run: |
        ALLOWED="Rimmn"
        CURRENT="${{ github.actor }}"
        
        echo "Checking: $CURRENT"
        echo "Allowed: $ALLOWED"
        echo ""
        
        if [ "$CURRENT" != "$ALLOWED" ]; then
          echo "‚ùå ERROR: User '$CURRENT' not authorized!"
          echo "Only '$ALLOWED' can modify critical files."
          echo ""
          echo "Protected files:"
          echo "- index.js"
          echo "- scurity.js"
          echo "- handler.js"
          echo "- settings.js"
          echo "- database.json"
          exit 1
        fi
        
        echo "‚úÖ Authorized user: $CURRENT"
        
    - name: ‚úÖ Success
      run: |
        echo "================================="
        echo "üéâ PROTECTION CHECK PASSED"
        echo "================================="
        echo "User: ${{ github.actor }}"
        echo "Status: VERIFIED"
        echo "Time: $(date)"
        echo "================================="
